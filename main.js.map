{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./libs/interfaces/src/index.ts","webpack:///./libs/utils/src/index.ts","webpack:///external \"tslib\"","webpack:///external \"tsoa\"","webpack:///external \"near-api-js\"","webpack:///external \"buffer\"","webpack:///./libs/baf-contract/src/index.ts","webpack:///./libs/crypto/src/index.ts","webpack:///external \"tweetnacl\"","webpack:///./libs/crypto/src/lib/hash.ts","webpack:///./apps/api/src/app/config/constants.ts","webpack:///./libs/near/src/lib/convert.ts","webpack:///./libs/torus/src/common/constants.ts","webpack:///./libs/utils/src/lib/bytes.ts","webpack:///./apps/api/src/app/chains/singletons.ts","webpack:///./libs/crypto/src/lib/keys.ts","webpack:///./libs/crypto/src/lib/sign.ts","webpack:///./libs/near/src/lib/utils.ts","webpack:///external \"elliptic\"","webpack:///./libs/near/src/index.ts","webpack:///./apps/api/src/environments/environment.test.ts","webpack:///./apps/api/src/app/controllers/NearController.ts","webpack:///./apps/api/src/app/service/near.ts","webpack:///external \"body-parser\"","webpack:///external \"@tsoa/runtime\"","webpack:///external \"bs58\"","webpack:///external \"near-api-js/lib/account_creator\"","webpack:///external \"near-api-js/lib/key_stores\"","webpack:///external \"@toruslabs/torus.js\"","webpack:///./libs/interfaces/src/lib/configs.ts","webpack:///./libs/interfaces/src/lib/chains.ts","webpack:///./libs/interfaces/src/lib/keysource.ts","webpack:///./libs/interfaces/src/lib/crypto.ts","webpack:///./libs/interfaces/src/lib/generic-tx.ts","webpack:///./libs/crypto/src/lib/crypto.ts","webpack:///./libs/crypto/src/lib/index.ts","webpack:///./libs/utils/src/lib/utils.ts","webpack:///./libs/utils/src/lib/conversions.ts","webpack:///./libs/utils/src/lib/types.ts","webpack:///./libs/utils/src/lib/user-verifier.ts","webpack:///./libs/utils/src/lib/serialize.ts","webpack:///./libs/baf-contract/src/lib/baf-contract.ts","webpack:///./libs/baf-contract/src/lib/constants.ts","webpack:///./libs/near/src/lib/near.ts","webpack:///./libs/multi-chain/src/lib/index.ts","webpack:///./libs/multi-chain/src/lib/switches.ts","webpack:///./libs/torus/src/common/torus.ts","webpack:///external \"express\"","webpack:///./apps/api/build/routes.ts","webpack:///./apps/api/src/app/controllers/DiscordController.ts","webpack:///./apps/api/src/app/service/discord.ts","webpack:///external \"form-data\"","webpack:///external \"axios\"","webpack:///external \"js-sha3\"","webpack:///external \"js-sha256\"","webpack:///./libs/near/src/lib/tx.ts","webpack:///external \"bn.js\"","webpack:///./libs/near/src/lib/rpc.ts","webpack:///./libs/near/src/lib/accounts.ts","webpack:///external \"near-api-js/lib/utils\"","webpack:///external \"dotenv\"","webpack:///./libs/multi-chain/src/index.ts","webpack:///./libs/torus/src/common/index.ts","webpack:///external \"@toruslabs/fetch-node-details\"","webpack:///external \"node-fetch\"","webpack:///./apps/api/src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 69);\n","export * from './lib/platforms';\nexport * from './lib/configs';\nexport * from './lib/chains';\nexport * from './lib/keysource';\nexport * from './lib/crypto';\nexport * from './lib/frontend';\nexport * from './lib/generic-tx';\n","export * from './lib/utils';\n","module.exports = require(\"tslib\");","module.exports = require(\"tsoa\");","module.exports = require(\"near-api-js\");","module.exports = require(\"buffer\");","export * from './lib/baf-contract';\nexport * from './lib/constants';\n","export * from './lib/crypto';\n","module.exports = require(\"tweetnacl\");","import * as sha3 from 'js-sha3';\nimport { sha256 as js_sha256 } from 'js-sha256';\n\nexport function keccak256(msg: Buffer): Buffer {\n  return Buffer.from(sha3.keccak256(msg), 'hex');\n}\n\nexport function sha256(msg: Buffer): Buffer {\n  return Buffer.from(js_sha256(msg), 'hex');\n}\n\n// add more wrappers here as needed\n","import { ed25519, ed25519Marker, Encoding, Env } from '@baf-wallet/interfaces';\nimport { keyPairFromSk } from '@baf-wallet/crypto';\nimport { NearInitParams, getNearNetworkID } from '@baf-wallet/near';\nimport { skFromString } from '@baf-wallet/utils';\nimport { environment, initDotEnv } from '../../environments/environment';\n\ninitDotEnv();\n\nexport const constants = {\n  chainParams: {\n    near: {\n      keyPair: keyPairFromSk<ed25519>(skFromString(process.env.NEAR_SK, ed25519Marker, Encoding.BS58)),\n      networkID: getNearNetworkID(environment.env),\n      masterAccountID: process.env.NEAR_MASTER_ACCOUNT_ID,\n    } as NearInitParams,\n  },\n  discord: {\n    clientId: process.env.DISCORD_CLIENT_ID,\n    clientSecret: process.env.DISCORD_CLIENT_SECRET,\n  },\n  torus: {\n    verifierName: 'discord',\n    network: environment.env === Env.PROD ? 'mainnet' : 'testnet',\n    proxyAddress: '0x4023d2a0D330bF11426B12C6144Cfb96B7fa6183',\n  },\n};\n","import {\n  Converter,\n  KeyPair,\n  PublicKey,\n  Encoding,\n} from '@baf-wallet/interfaces';\nimport { KeyPair as NearKeyPair, utils as NearUtils } from 'near-api-js';\nimport { bufferConverter, encodeBytes, formatBytes } from '@baf-wallet/utils';\nimport { Buffer } from 'buffer';\n\nexport const nearConverter: Converter<\n  NearUtils.PublicKey,\n  Buffer,\n  NearKeyPair\n> = {\n  ...bufferConverter,\n\n  pkToUnified<Curve>(\n    pk: NearUtils.PublicKey,\n    curveMarker: Curve\n  ): PublicKey<Curve> {\n    if (curveMarker.toString() !== 'ed25519') {\n      throw new Error(\n        'currently this function only supports ! Please specify the correct curve marker'\n      );\n    }\n    const data = Buffer.from(pk.data);\n    return {\n      curve: curveMarker,\n      data: data,\n      format: (fmt: Encoding) => formatBytes(data, fmt),\n    };\n  },\n\n  pkFromUnified: <Curve>(unifiedPk: PublicKey<Curve>): NearUtils.PublicKey =>\n    NearUtils.PublicKey.fromString(unifiedPk.format(Encoding.BS58)),\n\n  keyPairToUnified<Curve>(\n    keyPair: NearKeyPair,\n    curveMarker: Curve\n  ): KeyPair<Curve> {\n    const skFmt = keyPair.toString();\n    if (!skFmt.startsWith(curveMarker.toString())) {\n      throw new Error(\n        'keyPair is on the wrong curve! Please specify the correct curve in the type argument'\n      );\n    }\n\n    const skStr = skFmt.split(':')[1];\n    const skData = encodeBytes(skStr, Encoding.BS58);\n    const pkData = Buffer.from(keyPair.getPublicKey().data);\n\n    return {\n      curve: curveMarker,\n      pk: {\n        curve: curveMarker,\n        data: pkData,\n        format: (fmt: Encoding) => formatBytes(pkData, fmt),\n      },\n      sk: {\n        curve: curveMarker,\n        data: skData,\n        format: (fmt: Encoding) => formatBytes(skData, fmt),\n      },\n    };\n  },\n\n  keyPairFromUnified<Curve>(unifiedKeyPair: KeyPair<Curve>): NearKeyPair {\n    const prefix = unifiedKeyPair.curve.toString();\n    const skStr = unifiedKeyPair.sk.format(Encoding.BS58);\n    return NearKeyPair.fromString(`${prefix}:${skStr}`);\n  },\n};\n","import { LOGIN_TYPE } from '@toruslabs/torus-direct-web-sdk';\n\ntype VerifierInfo = {\n  [login_type in LOGIN_TYPE]?: {\n    verifier: string;\n    clientId: string;\n  };\n};\nexport const torusConstants = {\n  network: 'ropsten',\n  proxyAddress: '0x4023d2a0D330bF11426B12C6144Cfb96B7fa6183',\n  verifierInfo: {\n    discord: {\n      verifier: 'baf wallet-discord-testnet',\n      clientId: '821890148198776874',\n    },\n  } as VerifierInfo,\n};\n\nexport type TORUS_LOGIN_TYPE = LOGIN_TYPE;\n","import { Encoding, PublicKey, SecretKey } from '@baf-wallet/interfaces';\nimport * as bs58 from 'bs58';\n\nexport function formatBytes(buf: Buffer, fmt = Encoding.HEX) {\n  switch (fmt) {\n    case Encoding.HEX:\n      return Buffer.from(buf).toString('hex');\n    case Encoding.BS58:\n      return bs58.encode(Buffer.from(buf));\n    default:\n      throw 'Encoding type not supported';\n  }\n}\n\nexport function encodeBytes(str: string, fmt: Encoding): Buffer {\n  switch (fmt) {\n    case Encoding.HEX:\n      return Buffer.from(str, 'hex');\n    case Encoding.BS58:\n      return bs58.decode(str);\n    case Encoding.UTF8:\n      return Buffer.from(str, 'utf8');\n    default:\n      throw 'Encoding type not supported';\n  }\n}\n\nexport function pkToArray<Curve>(key: PublicKey<Curve>): number[] {\n  return [...key.data];\n}\n\nexport function pkToString<Curve>(\n  key: PublicKey<Curve>,\n  keyFormat = Encoding.HEX\n): string {\n  return formatBytes(key.data, keyFormat);\n}\n\nexport function pkFromString<Curve>(\n  key: string,\n  curve: Curve,\n  keyFormat = Encoding.HEX\n): PublicKey<Curve> {\n  const data = encodeBytes(key, keyFormat);\n  return {\n    data,\n    curve,\n    format: (fmt: Encoding) => formatBytes(data, fmt),\n  };\n}\n\nexport function skFromString<Curve>(\n  key: string,\n  curve: Curve,\n  keyFormat = Encoding.HEX\n): SecretKey<Curve> {\n  const data = encodeBytes(key, keyFormat);\n  return {\n    data,\n    curve,\n    format: (fmt: Encoding) => formatBytes(data, fmt),\n  };\n}\n","import { Chain } from '@baf-wallet/interfaces';\nimport { getWrappedInterface } from '@baf-wallet/multi-chain';\nimport {\n  NearChainInterface,\n  WrappedNearChainInterface,\n} from '@baf-wallet/near';\nimport { constants } from '../config/constants';\n\nlet nearChain: WrappedNearChainInterface;\nlet init = false;\nexport async function initChains() {\n  nearChain = await getWrappedInterface<NearChainInterface>(\n    Chain.NEAR,\n    constants.chainParams[Chain.NEAR]\n  );\n  init = true;\n}\n\nexport function getNearChain(): WrappedNearChainInterface {\n  if (!init) throw 'You must first initialize the chains';\n  return nearChain;\n}\n","import {\n  PublicKey,\n  SecretKey,\n  KeyPair,\n  SECP256K1_STR,\n  ED25519_STR,\n  secp256k1,\n  secp256k1Marker,\n} from '@baf-wallet/interfaces';\nimport { bufferConverter } from '@baf-wallet/utils';\nimport { ec as EC } from 'elliptic';\nimport * as nacl from 'tweetnacl';\n\nconst ellipticSecp256k1 = new EC('secp256k1');\n\nexport function pkSecpFromXY(x: string, y: string): PublicKey<secp256k1> {\n  const key = ellipticSecp256k1.keyFromPublic({ x, y }, 'hex');\n  return bufferConverter.pkToUnified(\n    Buffer.from(key.getPublic('array')),\n    secp256k1Marker\n  );\n}\n\nexport function keyPairFromSk<Curve>(sk: SecretKey<Curve>): KeyPair<Curve> {\n  const pk = pkFromSk(sk);\n  return {\n    curve: sk.curve,\n    pk,\n    sk,\n  };\n}\n\nexport function pkFromSk<Curve>(sk: SecretKey<Curve>): PublicKey<Curve> {\n  switch (sk.curve.toString()) {\n    case SECP256K1_STR: {\n      const data = Buffer.from(\n        ellipticSecp256k1.keyFromPrivate(sk.data).getPublic(false, 'hex'),\n        'hex'\n      );\n\n      return bufferConverter.pkToUnified(data, sk.curve);\n    }\n    case ED25519_STR: {\n      const data = Buffer.from(\n        nacl.sign.keyPair.fromSecretKey(new Uint8Array(sk.data)).publicKey\n      );\n\n      return bufferConverter.pkToUnified(data, sk.curve);\n    }\n    default:\n      throw new Error(`Unsupported curve ${sk.curve.toString()}`);\n  }\n}\n\nexport function skFromSeed<Curve>(\n  seed: Uint8Array,\n  curveMarker: Curve\n): SecretKey<Curve> {\n  switch (curveMarker.toString()) {\n    case SECP256K1_STR: {\n      const entropy = nacl.hash(seed);\n      const ellipticSk = ellipticSecp256k1\n        .genKeyPair({ entropy })\n        .getPrivate('hex');\n\n      const data = Buffer.from(ellipticSk, 'hex');\n      return bufferConverter.skToUnified(data, curveMarker);\n    }\n    case ED25519_STR: {\n      const data = Buffer.from(\n        nacl.sign.keyPair.fromSeed(new Uint8Array(Buffer.from(seed))).secretKey\n      );\n\n      return bufferConverter.pkToUnified(data, curveMarker);\n    }\n    default:\n      throw new Error(`Unsupported curve ${curveMarker.toString()}`);\n  }\n}\n\nexport function skFromRng<Curve>(curveMarker: Curve): SecretKey<Curve> {\n  switch (curveMarker.toString()) {\n    case ED25519_STR: {\n      const data = Buffer.from(nacl.sign.keyPair().secretKey);\n      return bufferConverter.skToUnified(data, curveMarker);\n    }\n    case SECP256K1_STR: {\n      const data = Buffer.from(\n        ellipticSecp256k1.genKeyPair().getPrivate('hex'),\n        'hex'\n      );\n      return bufferConverter.pkToUnified(data, curveMarker);\n    }\n    default:\n      throw new Error(`Unsupported curve ${curveMarker.toString()}`);\n  }\n}\n","import {\n  SecretKey,\n  PublicKey,\n  KeyPair,\n  secp256k1,\n  ed25519,\n  ED25519_STR,\n  SECP256K1_STR,\n  Encoding,\n} from '@baf-wallet/interfaces';\nimport { keccak256, sha256 } from './hash';\nimport { ec as EC } from 'elliptic';\nimport * as nacl from 'tweetnacl';\nimport { encodeBytes } from '@baf-wallet/utils';\nimport { encodeSecpSigBafContract } from '@baf-wallet/baf-contract';\n\nconst ellipticSecp256k1 = new EC('secp256k1');\n\nexport function verifySignature<Curve>(\n  pk: PublicKey<Curve>,\n  msg: Buffer | string,\n  signedMsg: Buffer,\n  hashFn: (buf: Buffer) => Buffer = keccak256\n): boolean {\n  const msgFormat =\n    typeof msg === 'string' ? encodeBytes(msg, Encoding.UTF8) : msg;\n  switch (pk.curve.toString()) {\n    case SECP256K1_STR: {\n      const msgHash = hashFn(msgFormat);\n      let validSig = ellipticSecp256k1.verify(msgHash, signedMsg, pk.data);\n      return validSig;\n    }\n    case ED25519_STR: {\n      const msgHash = hashFn(msgFormat);\n      return nacl.sign.detached.verify(\n        new Uint8Array(msgHash),\n        new Uint8Array(signedMsg),\n        new Uint8Array(pk.data)\n      );\n    }\n    default:\n      throw new Error(`Unsupported curve ${pk.curve.toString()}`);\n  }\n}\n\nexport function signMsg<Curve>(\n  sk: SecretKey<Curve>,\n  msg: Buffer | string,\n  bafContractFormat = false,\n  hashFn: (buf: Buffer) => Buffer = keccak256\n): Buffer {\n  const msgFormat =\n    typeof msg === 'string' ? encodeBytes(msg, Encoding.UTF8) : msg;\n  switch (sk.curve.toString()) {\n    case SECP256K1_STR: {\n      const msgHash = hashFn(msgFormat);\n      const ellipticSig = ellipticSecp256k1.sign(msgHash, sk.data, 'hex', {\n        canonical: true,\n      });\n      return bafContractFormat\n        ? encodeSecpSigBafContract(ellipticSig)\n        : Buffer.from(ellipticSig.toDER('hex'), 'hex');\n    }\n    case ED25519_STR: {\n      const msgHash = hashFn(msgFormat);\n      return Buffer.from(\n        nacl.sign.detached(new Uint8Array(msgHash), new Uint8Array(sk.data))\n      );\n    }\n    default:\n      throw new Error(`Unsupported curve ${sk.curve.toString()}`);\n  }\n}\n","import { Env } from '@baf-wallet/interfaces';\n\nexport enum NearNetworkID {\n  DEVNET = 'testnet',\n  TESTNET = 'testnet',\n  MAINNET = 'mainnet',\n}\n\nexport function stringToNetworkID(str: string): NearNetworkID {\n  switch (str) {\n    case NearNetworkID.DEVNET:\n      return NearNetworkID.DEVNET;\n    case NearNetworkID.TESTNET:\n      return NearNetworkID.TESTNET;\n    case NearNetworkID.MAINNET:\n      return NearNetworkID.MAINNET;\n    default:\n      throw new Error(`Unknown network identifier ${str}`);\n  }\n}\n\nexport function getNearNetworkID(env: Env): NearNetworkID {\n  switch (env) {\n    case Env.DEV:\n      return NearNetworkID.DEVNET;\n    case Env.TEST:\n      return NearNetworkID.TESTNET;\n    case Env.PROD:\n      return NearNetworkID.MAINNET;\n    default:\n      return NearNetworkID.DEVNET;\n  }\n}\n","module.exports = require(\"elliptic\");","export * from './lib/near';\nexport * from './lib/utils';\n","import { Env } from '@baf-wallet/interfaces';\nimport { config as dotenvConfig } from 'dotenv';\n\nexport function initDotEnv() {\n  if (!process.env.NON_LOCAL)\n    dotenvConfig({ path: './apps/api/src/environments/.env.test' });\n}\n\nexport const environment = {\n  env: Env.TEST,\n  production: false,\n};\n","import {\n  Body,\n  Controller,\n  Get,\n  Path,\n  Post,\n  Query,\n  Route,\n  SuccessResponse,\n} from 'tsoa';\n\nimport {\n  createNearAccount,\n  getAccountInfoFromSecpPK,\n  getAccountNonce,\n  NearAccountInfo,\n} from '../service/near';\nimport {\n  ed25519Marker,\n  Encoding,\n  PublicKey,\n  secp256k1Marker,\n} from '@baf-wallet/interfaces';\nimport { getTorusPublicAddress } from '@baf-wallet/torus';\nimport { constants } from '../config/constants';\nimport { hexString } from './common';\nimport { pkFromString } from '@baf-wallet/utils';\n\ninterface CreateNearAccountParams {\n  userID: string;\n  nonce: hexString;\n  secpSigHex: hexString;\n  secpSig_s: hexString;\n  edPubkey: hexString;\n  edSigHex: hexString;\n  accountID: string;\n}\n\n@Route('near')\nexport class NearController extends Controller {\n  @SuccessResponse('204')\n  @Post('account')\n  public async createNearAccount(\n    @Body() requestBody: CreateNearAccountParams\n  ): Promise<void> {\n    const secpPubkey = await getTorusPublicAddress(\n      requestBody.userID,\n      'discord'\n    );\n\n    await createNearAccount(\n      secpPubkey,\n      pkFromString(requestBody.edPubkey, ed25519Marker, Encoding.HEX),\n      requestBody.userID,\n      requestBody.nonce,\n      requestBody.secpSigHex,\n      requestBody.secpSig_s,\n      requestBody.edSigHex,\n      requestBody.accountID\n    );\n  }\n\n  @SuccessResponse('200')\n  @Get('account/{secpPubkeyB58}/nonce')\n  public async getAccountNonce(@Path() secpPubkeyB58: string): Promise<string> {\n    const pk = pkFromString(secpPubkeyB58, secp256k1Marker, Encoding.BS58);\n    return await getAccountNonce(pk);\n  }\n\n  @SuccessResponse('200')\n  @Get('account/{secpPubkeyB58}/id')\n  public async getAccountInfo(\n    @Path() secpPubkeyB58: string\n  ): Promise<NearAccountInfo> {\n    const pk = pkFromString(secpPubkeyB58, secp256k1Marker, Encoding.BS58);\n    return await getAccountInfoFromSecpPK(pk);\n  }\n}\n","import {\n  ed25519,\n  Encoding,\n  PublicKey,\n  secp256k1,\n} from '@baf-wallet/interfaces';\nimport { PublicKey as NearPublicKey } from 'near-api-js/lib/utils';\nimport { getBafContract } from '@baf-wallet/baf-contract';\nimport {\n  createUserVerifyMessage,\n  encodeBytes,\n  formatBytes,\n  pkToString,\n} from '@baf-wallet/utils';\nimport { verifySignature } from '@baf-wallet/crypto';\nimport { getNearChain } from '../chains/singletons';\n\nexport interface NearAccountInfo {\n  near_id: string | null;\n}\n\n// Check the found public key verifies the signature produced by (nonce + userId)\nexport async function createNearAccount(\n  secpPK: PublicKey<secp256k1>,\n  edPK: PublicKey<ed25519>,\n  userId: string,\n  nonce: string,\n  secpSig: string,\n  rustEncodedSecpSig: string,\n  edSig: string,\n  accountID: string\n) {\n  const msg = createUserVerifyMessage(userId, nonce);\n  const sigsValid = verifyBothSigs(msg, secpSig, edSig, secpPK, edPK);\n\n  if (!sigsValid) {\n    throw 'Proof that the sender owns this public key must provided';\n  }\n\n  const near = await getNearChain();\n\n  const nearAccount = near.accounts;\n  await nearAccount.create({\n    accountID,\n    newAccountPk: edPK,\n  });\n\n  const bafContract = await getBafContract();\n  await bafContract.setAccountInfo(\n    secpPK,\n    userId,\n    encodeBytes(rustEncodedSecpSig, Encoding.HEX),\n    accountID\n  );\n}\n\nexport async function getAccountNonce(\n  pk: PublicKey<secp256k1>\n): Promise<string> {\n  return await getBafContract().getAccountNonce(pk);\n}\n\nexport async function getAccountInfoFromSecpPK(\n  pk: PublicKey<secp256k1>\n): Promise<NearAccountInfo> {\n  return {\n    near_id: await getBafContract().getAccountId(pk),\n  };\n}\n\nfunction verifyBothSigs(\n  msg: string,\n  secpSig: string,\n  edSig: string,\n  secpPubkey: PublicKey<secp256k1>,\n  edPubkey: PublicKey<ed25519>\n): boolean {\n  return (\n    verifySignature(secpPubkey, msg, encodeBytes(secpSig, Encoding.HEX)) &&\n    verifySignature(edPubkey, msg, encodeBytes(edSig, Encoding.HEX))\n  );\n}\n","module.exports = require(\"body-parser\");","module.exports = require(\"@tsoa/runtime\");","module.exports = require(\"bs58\");","module.exports = require(\"near-api-js/lib/account_creator\");","module.exports = require(\"near-api-js/lib/key_stores\");","module.exports = require(\"@toruslabs/torus.js\");","export enum Env {\n  DEV,\n  TEST,\n  PROD,\n}\n","import { PublicKey, SecretKey, KeyPair, secp256k1, ed25519 } from './crypto';\nimport { Pair } from '@baf-wallet/utils';\nimport { Account as NearAccount } from 'near-api-js';\nimport {\n  GenericTxAction,\n  GenericTxParams,\n  GenericTxSupportedActions,\n} from './generic-tx';\n\nexport enum Chain {\n  NEAR = 'near',\n}\n// // TODO: have some intelligent way to get the rest\n// export enum Chain {\n//   ETH = 'ethereum',\n//   BTC = 'bitcoin',\n//   NEAR = 'near',\n//   SOLANA = 'solana',\n//   COSMOS = 'cosmos',\n//   CELO = 'celo',\n//   DOT = 'polkadot',\n//   FILECOIN = 'filecoin',\n//   HARMONEY = 'harmony',\n//   ALGORAND = 'algorand',\n//   AVALANCHE = 'avalanche',\n//   MATIC = 'matic',\n//   DOGE = 'doge',\n//   TERRA = 'terra',\n// }\n\n// Or the type with all the supported chain account types\nexport type ChainAccount = NearAccount;\n\nexport type Balance = string;\n\nexport interface ChainBalance {\n  chain: Chain;\n  balance: Balance;\n}\n\nexport type ExplorerLink = string;\n\n// ChainInterface but with the partial application already done via a closure somewhere\n// for instance, wrapChainInterface in @baf-wallet/multi-chain/switches\nexport interface WrappedChainInterface<\n  PK,\n  SK,\n  KP,\n  Inner,\n  Tx,\n  BuildTxParams,\n  SignedTx,\n  SignOpts,\n  SendOpts,\n  SendResult,\n  Account,\n  AccountLookupParams,\n  AccountCreateParams\n> {\n  rpc: RpcInterface<Tx, SignedTx, SendOpts, SendResult>;\n  tx: TxInterface<Tx, BuildTxParams, SignedTx, SignOpts, SendOpts, SendResult>;\n  accounts: AccountsInterface<\n    Account,\n    AccountLookupParams,\n    AccountCreateParams\n  >;\n  convert: Converter<PK, SK, KP>;\n  getInner: () => Inner;\n}\n\n// interface that every chain implementation is expected to implement\n// the 'innerSdk' HOF's are the way they are because most SDK's tend to be stateful (booooo)\n// which we need to be able to keep track of.\n// Since every SDK is probably going to be stateful, if at all, in a slightly different way,\n// we need to decouple the sdk's state from the actual functionality. If the 'Inner' type is expected\n// to contain all of the SDK's state, partial application affords us the flexibility we need to deal with\n// any kind of statefulness. Note that Inner can theoretically be void in the case that the underlying\n// SDK is stateless\nexport interface ChainInterface<\n  PK,\n  SK,\n  KP,\n  InitParams,\n  Inner,\n  Tx,\n  BuildTxParams,\n  SignedTx,\n  SignOpts,\n  SendOpts,\n  SendResult,\n  Account,\n  AccountLookupParams,\n  AccountCreateParams\n> {\n  rpc: (innerSdk: Inner) => RpcInterface<Tx, SignedTx, SendOpts, SendResult>;\n  tx: (\n    innerSdk: Inner\n  ) => TxInterface<Tx, BuildTxParams, SignedTx, SignOpts, SendOpts, SendResult>;\n  accounts: (\n    innerSdk: Inner\n  ) => AccountsInterface<Account, AccountLookupParams, AccountCreateParams>;\n  init: (params: InitParams) => Promise<Inner>;\n  convert: Converter<PK, SK, KP>;\n}\n\nexport interface AccountsInterface<Account, LookupParams, CreateParams> {\n  lookup: (params: LookupParams) => Promise<Account>;\n  create: (params: CreateParams) => Promise<Account>;\n  getGenericMasterAccount: () => GenericAccount;\n}\n\nexport interface GenericAccount {\n  getBalance: () => Promise<Balance>;\n}\n\n// bare minimum interface representing direct RPC methods to the chain\n// chains are expected to extend this with their own functions and/or values\nexport interface RpcInterface<Tx, SignedTx, SendOpts, SendResult> {\n  endpoint: (network?: string) => string;\n}\n\n// minimum interface representing all transaction-related operations\n// chains are expected to extend this with their own functions and/or values\nexport interface TxInterface<\n  Tx,\n  BuildTxParams,\n  SignedTx,\n  SignOpts,\n  SendOpts,\n  SendResult\n> {\n  build: (params: BuildTxParams) => Promise<Tx>;\n  sign: <Curve>(\n    tx: Tx,\n    keyPair: KeyPair<Curve>,\n    opts?: SignOpts\n  ) => Promise<SignedTx>;\n  send: (\n    tx: Tx | SignedTx,\n    opts?: SendOpts\n  ) => Promise<Pair<SendResult, ExplorerLink>>;\n  buildParamsFromGenericTx: (\n    params: GenericTxParams,\n    recipientPk: PublicKey<secp256k1>,\n    senderPkSecp: PublicKey<secp256k1>,\n    senderPkEd: PublicKey<ed25519>\n  ) => Promise<BuildTxParams>;\n  extractGenericActionsFromTx: (params: BuildTxParams) => GenericTxAction[];\n}\n\n// utility for going to/from key BAF Wallet unified types\n// each instance expected to be specific to a particular sdk so that\n// we aren't ever locked into using BAF types and reimplementing wheelsA\n// chains are expected to extend this with their own functions and/or values\nexport interface Converter<PK, SK, KP> {\n  skFromUnified: <Curve>(unifiedSk: SecretKey<Curve>) => SK;\n  skToUnified: <Curve>(sk: SK, curveMarker: Curve) => PublicKey<Curve>;\n  pkFromUnified: <Curve>(unifiedPk: PublicKey<Curve>) => PK;\n  pkToUnified: <Curve>(pk: PK, curveMarker: Curve) => SecretKey<Curve>;\n  keyPairFromUnified: <Curve>(unifiedKeyPair: KeyPair<Curve>) => KP;\n  keyPairToUnified: <Curve>(\n    unifiedKeyPair: KP,\n    curveMaker: Curve\n  ) => KeyPair<Curve>;\n  // add more methods for converting shit as necessary\n}\n\nexport type InferChainInterface<T> = T extends ChainInterface<\n  infer PK,\n  infer SK,\n  infer KP,\n  infer InitParams,\n  infer Inner,\n  infer Tx,\n  infer BuildTxParams,\n  infer SignedTx,\n  infer SignOpts,\n  infer SendOpts,\n  infer SendResult,\n  infer Account,\n  infer AccountLookupParams,\n  infer AccountCreateParams\n>\n  ? ChainInterface<\n      PK,\n      SK,\n      KP,\n      InitParams,\n      Inner,\n      Tx,\n      BuildTxParams,\n      SignedTx,\n      SignOpts,\n      SendOpts,\n      SendResult,\n      Account,\n      AccountLookupParams,\n      AccountCreateParams\n    >\n  : never;\nexport type InferWrappedChainInterface<T> = T extends WrappedChainInterface<\n  infer PK,\n  infer SK,\n  infer KP,\n  infer Inner,\n  infer Tx,\n  infer BuildTxParams,\n  infer SignedTx,\n  infer SignOpts,\n  infer SendOpts,\n  infer SendResult,\n  infer Account,\n  infer AccountLookupParams,\n  infer AccountCreateParams\n>\n  ? WrappedChainInterface<\n      PK,\n      SK,\n      KP,\n      Inner,\n      Tx,\n      BuildTxParams,\n      SignedTx,\n      SignOpts,\n      SendOpts,\n      SendResult,\n      Account,\n      AccountLookupParams,\n      AccountCreateParams\n    >\n  : never;\n\nexport type InferWrapChainInterface<T> = T extends ChainInterface<\n  infer PK,\n  infer SK,\n  infer KP,\n  infer _,\n  infer Inner,\n  infer Tx,\n  infer BuildTxParams,\n  infer SignedTx,\n  infer SignOpts,\n  infer SendOpts,\n  infer SendResult,\n  infer Account,\n  infer AccountLookupParams,\n  infer AccountCreateParams\n>\n  ? WrappedChainInterface<\n      PK,\n      SK,\n      KP,\n      Inner,\n      Tx,\n      BuildTxParams,\n      SignedTx,\n      SignOpts,\n      SendOpts,\n      SendResult,\n      Account,\n      AccountLookupParams,\n      AccountCreateParams\n    >\n  : never;\n\nexport type InferPK<T> = T extends ChainInterface<\n  infer PK,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? PK\n  : never;\nexport type InferSK<T> = T extends ChainInterface<\n  infer _,\n  infer SK,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? SK\n  : never;\nexport type InferKP<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer KP,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? KP\n  : never;\nexport type InferInitParams<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer InitParams,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? InitParams\n  : never;\nexport type InferInner<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer Inner,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? Inner\n  : never;\nexport type InferTx<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer Tx,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? Tx\n  : never;\nexport type InferTxBuildParams<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer TxBuildParams,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? TxBuildParams\n  : never;\n\nexport type InferSignedTx<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer SignedTx,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? SignedTx\n  : never;\nexport type InferSignOpts<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer SignOpts,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? SignOpts\n  : never;\nexport type InferSendOpts<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer SendOpts,\n  infer _,\n  infer _,\n  infer _,\n  infer _\n>\n  ? SendOpts\n  : never;\nexport type InferSendResult<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer SendResult,\n  infer _,\n  infer _,\n  infer _\n>\n  ? SendResult\n  : never;\nexport type InferAccount<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer Account,\n  infer _,\n  infer _\n>\n  ? Account\n  : never;\nexport type InferAccountLookupParams<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer AccountLookupParams,\n  infer _\n>\n  ? AccountLookupParams\n  : never;\nexport type InferAccountCreateParams<T> = T extends ChainInterface<\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer _,\n  infer AccountCreateParams\n>\n  ? AccountCreateParams\n  : never;\n","import { SupportedCurve, KeyPair } from './crypto';\n\nexport enum KeySourceMethod {\n  TORUS,\n  LOCAL_STORAGE,\n  // e.g. file, ledger, brain, etc, as they are implemented\n}\n\n// `KeyID` is a type that represents the type used to \"look up\" a key\n// in theory this could be the public key itself, but some source mechanisms\n// may offer different ways of doing so, for instance the key for use in localStorage.setItem\n// a file path, or a derived account number for a keypair stored on a ledger nano\nexport interface KeySource<KeyID> {\n  method: KeySourceMethod;\n  getKeyPair: <Curve>(\n    keyID: KeyID,\n    curveMarker: Curve\n  ) => Promise<KeyPair<Curve> | null>;\n\n  // these methods are for the off-chance that you don't know which curve a particular key-pair is on\n  // to use this, you'd typically call this and then case on the returned value\n  // for the vast majority of cases there will be only one curve used by a particular key source mechansim\n  // so these method aren't required.\n  // implementors are expected to implement either all of these methods or none of them.\n  getKeyCurve?: (keyID: KeyID) => Promise<SupportedCurve>;\n  getKeyPairUnknownCurve?: (keyID: KeyID) => Promise<KeyPair<SupportedCurve>>;\n}\n\n// then every keySource implementation should provide this function\nexport type KeySourceInitFn<KeyID, InitParams> = (\n  params: InitParams\n) => Promise<KeySource<KeyID>>;\n\nexport type KeySourceInferKeyID<T> = T extends KeySource<infer KeyID>\n  ? KeyID\n  : never;\nexport type KeySourceInitFnInferInitParams<T> = T extends KeySourceInitFn<\n  infer _,\n  infer InitParams\n>\n  ? InitParams\n  : never;\n","import { Buffer } from 'buffer';\n\nexport type secp256k1 = {\n  toString: () => 'secp256k1';\n};\n\nexport type ed25519 = {\n  toString: () => 'ed25519';\n};\n\nexport const ED25519_STR = 'ed25519';\nexport const SECP256K1_STR = 'secp256k1';\n\nexport const secp256k1Marker: secp256k1 = { toString: () => SECP256K1_STR };\nexport const ed25519Marker: ed25519 = { toString: () => ED25519_STR };\n\nexport type SupportedCurve = secp256k1 | ed25519;\n\nexport enum Encoding {\n  BS58,\n  HEX,\n  UTF8,\n}\n\nexport interface PublicKey<Curve> {\n  data: Buffer;\n  curve: Curve;\n  format: (fmt: Encoding) => string;\n}\n\nexport interface SecretKey<Curve> {\n  data: Buffer;\n  curve: Curve;\n  format: (fmt: Encoding) => string;\n}\n\nexport interface KeyPair<Curve> {\n  curve: Curve;\n  sk: SecretKey<Curve>;\n  pk: PublicKey<Curve>;\n}\n/**\n * A hex encoded string for the signature where sig.s is concated with sig.r\n */\nexport type RustEncodedSecpSig = Buffer;\n","import { PLATFORM } from './platforms';\n\nexport enum GenericTxSupportedActions {\n  TRANSFER = 'transfer',\n}\n\nexport interface GenericTxParams {\n  recipientUserId: string;\n  recipientUserIdReadable: string;\n  oauthProvider: PLATFORM;\n  actions: GenericTxAction[];\n}\n\ninterface GenericTxActionBase {\n  type: GenericTxSupportedActions;\n}\n\nexport interface GenericTxActionTransfer extends GenericTxActionBase {\n  type: GenericTxSupportedActions.TRANSFER;\n  // Amount is the quantity of the minimal sendable unit for a currency\n  amount: string;\n}\n\n// To be or'd with whatever other actions we use\nexport type GenericTxAction = GenericTxActionTransfer;\n","export * from './hash';\nexport * from './index';\nexport * from './keys';\nexport * from './sign';\n","export * from './keys';\nexport * from './hash';\nexport * from './sign';\n","export * from './bytes';\nexport * from './conversions';\nexport * from './types';\nexport * from './user-verifier';\nexport * from './serialize';\n","import {\n  Converter,\n  SecretKey,\n  PublicKey,\n  Encoding,\n  KeyPair,\n} from '@baf-wallet/interfaces';\nimport { formatBytes } from './bytes';\nimport { Pair } from './types';\nimport { Buffer } from 'buffer';\n\nexport const bufferConverter: Converter<\n  Buffer,\n  Buffer,\n  Pair<Buffer, Buffer>\n> = {\n  skFromUnified,\n  skToUnified,\n  pkFromUnified,\n  pkToUnified,\n  keyPairFromUnified,\n  keyPairToUnified,\n};\n\nfunction skFromUnified<Curve>(unifiedSk: SecretKey<Curve>): Buffer {\n  return Buffer.from(unifiedSk.data);\n}\n\nfunction skToUnified<Curve>(sk: Buffer, curveMarker: Curve): SecretKey<Curve> {\n  const data = Buffer.from(sk);\n  return {\n    data,\n    curve: curveMarker,\n    format: (fmt: Encoding) => formatBytes(data, fmt),\n  };\n}\n\nfunction pkFromUnified<Curve>(bafPk: PublicKey<Curve>): Buffer {\n  return Buffer.from(bafPk.data);\n}\n\nfunction pkToUnified<Curve>(pk: Buffer, curveMarker: Curve): PublicKey<Curve> {\n  const data = Buffer.from(pk);\n  return {\n    data,\n    curve: curveMarker,\n    format: (fmt: Encoding) => formatBytes(data, fmt),\n  };\n}\n\nfunction keyPairFromUnified<Curve>(\n  unifiedKeyPair: KeyPair<Curve>\n): Pair<Buffer, Buffer> {\n  const { pk, sk } = unifiedKeyPair;\n  return {\n    fst: Buffer.from(sk.data),\n    snd: Buffer.from(pk.data),\n  };\n}\n\nfunction keyPairToUnified<Curve>(\n  keyPair: Pair<Buffer, Buffer>,\n  curveMarker: Curve\n): KeyPair<Curve> {\n  const skBytes = keyPair.fst;\n  const pkBytes = keyPair.snd;\n  return {\n    curve: curveMarker,\n    sk: skToUnified(skBytes, curveMarker),\n    pk: pkToUnified(pkBytes, curveMarker),\n  };\n}\n","export type Pair<T, U> = {\n  fst: T;\n  snd: U;\n};\n\nexport const getEnumValues = (enumObj: any) =>\n  Object.keys(enumObj).map((key) => enumObj[key]);\n","export function createUserVerifyMessage(userId: string, nonce: string) {\n  return `${userId}:${nonce}`;\n}\n","export const serializeData = (data: any) => JSON.stringify(data);\n// TODO: add type checking. See https://github.com/bafnetwork/baf-wallet-v2/issues/36\nexport const deserializeData = <T>(uriEncoded: string) =>\n  JSON.parse(uriEncoded) as T;\n","import { Account, Contract, Near } from 'near-api-js';\nimport ContractConfig from '../../config.json';\nimport { ec as EC } from 'elliptic';\nimport {\n  PublicKey,\n  RustEncodedSecpSig,\n  secp256k1,\n} from '@baf-wallet/interfaces';\nimport { NearAccountID } from '@baf-wallet/near';\nimport { pkToArray, pkToString } from '@baf-wallet/utils';\n\ninterface BafContract {\n  getAccountId: (pk: PublicKey<secp256k1>) => Promise<NearAccountID | null>;\n  getAccountNonce: (secp_pk: PublicKey<secp256k1>) => Promise<string>;\n  setAccountInfo: (\n    secp_pk: PublicKey<secp256k1>,\n    user_id: string,\n    secp_sig_s: RustEncodedSecpSig,\n    new_account_id: NearAccountID\n  ) => Promise<void>;\n  deleteAccountInfo: (\n    secp_pk: PublicKey<secp256k1>,\n    user_id: string,\n    secp_sig_s: RustEncodedSecpSig\n  ) => Promise<void>;\n}\n\nlet bafContract: BafContract;\n\nexport async function setBafContract(account: Account): Promise<BafContract> {\n  bafContract = await buildBafContract(account);\n  return bafContract;\n}\n\nexport function getBafContract(): BafContract {\n  if (bafContract) return bafContract;\n  throw 'BAF Contract is not initialized yet, please call setBafContract';\n}\n\nasync function buildBafContract(account: Account): Promise<BafContract> {\n  const contract = new Contract(account, ContractConfig.contractName, {\n    viewMethods: ['get_account_id', 'get_account_nonce'],\n    changeMethods: ['set_account_info', 'delete_account_info'],\n  });\n  return {\n    getAccountId: async (pk) => {\n      const ret = await (contract as any).get_account_id({\n        secp_pk: pkToArray(pk),\n      });\n      if (!ret || ret === '') return null;\n      else return ret as NearAccountID;\n    },\n    getAccountNonce: (pk) =>\n      (contract as any).get_account_nonce({\n        secp_pk: pkToArray(pk),\n      }) as Promise<string>,\n    setAccountInfo: (pk, user_id, secp_sig_s, new_account_id) =>\n      (contract as any).set_account_info({\n        user_id,\n        secp_pk: pkToArray(pk),\n        secp_sig_s: [...secp_sig_s],\n        new_account_id,\n      }),\n    deleteAccountInfo: (pk, user_id, secp_sig_s) =>\n      (contract as any).delete_account_info({\n        user_id,\n        secp_pk: pkToArray(pk),\n        secp_sig_s: [...secp_sig_s],\n      }),\n  };\n}\n\nexport function encodeSecpSigBafContract(sig: EC.Signature): Buffer {\n  return Buffer.from(\n    `${sig.r.toString('hex', 64)}${sig.s.toString('hex', 64)}`,\n    'hex'\n  );\n}\n","export const bafContractConstants = {\n  // :)\n  beneficiaryId: 'lev.near',\n};\n","import {\n  ChainInterface,\n  ed25519,\n  Encoding,\n  InferWrapChainInterface,\n  KeyPair,\n  secp256k1,\n} from '@baf-wallet/interfaces';\nimport {\n  Account,\n  connect,\n  ConnectConfig,\n  KeyPair as NearKeyPair,\n  Near,\n  providers,\n  transactions,\n  utils as NearUtils,\n} from 'near-api-js';\n\nimport { NearBuildTxParams, NearSignTxOpts, nearTx } from './tx';\nimport { nearRpc, NearSendOpts, NearSendResult } from './rpc';\nimport {\n  NearAccountID,\n  nearAccounts,\n  NearCreateAccountParams,\n} from './accounts';\nimport { nearConverter } from './convert';\nimport { NearNetworkID } from './utils';\nimport { InMemoryKeyStore } from 'near-api-js/lib/key_stores';\nimport { KeyPairEd25519 as NearKeyPairEd25519 } from 'near-api-js/lib/utils';\n\nexport type { NearAccountID, NearCreateAccountParams } from './accounts';\nexport type {\n  NearTransaction,\n  NearBuildTxParams,\n  NearAction,\n  NearSupportedActionTypes,\n} from './tx';\nexport type WrappedNearChainInterface = InferWrapChainInterface<NearChainInterface>;\n\nexport type NearChainInterface = ChainInterface<\n  NearUtils.PublicKey,\n  Buffer,\n  NearKeyPair,\n  NearInitParams,\n  NearState,\n  transactions.Transaction,\n  NearBuildTxParams,\n  transactions.SignedTransaction,\n  NearSignTxOpts,\n  NearSendOpts,\n  NearSendResult,\n  Account,\n  NearAccountID,\n  NearCreateAccountParams\n>;\n\nexport interface NearState {\n  near: Near;\n  rpcProvider: providers.JsonRpcProvider;\n  networkID: NearNetworkID;\n  nearMasterAccount: Account;\n}\n\nexport const nearChainInterface: NearChainInterface = {\n  accounts: nearAccounts,\n  tx: nearTx,\n  convert: nearConverter,\n  rpc: nearRpc,\n  init,\n};\n\nexport interface NearInitParams {\n  networkID: NearNetworkID;\n  masterAccountID: NearAccountID;\n  keyPath?: string;\n  keyPair?: KeyPair<ed25519>;\n}\n\nasync function init({\n  networkID,\n  masterAccountID,\n  keyPath,\n  keyPair,\n}: NearInitParams): Promise<NearState> {\n  const nodeUrl = `https://rpc.${networkID}.near.org`;\n  const connectConfig = {\n    networkId: networkID,\n    nodeUrl,\n    helperUrl: `https://helper.${networkID}.near.org`,\n    masterAccount: masterAccountID,\n    keyPath,\n  } as ConnectConfig;\n  if (keyPair) {\n    const keyStore = new InMemoryKeyStore();\n    const nearKp = new NearKeyPairEd25519(keyPair.sk.format(Encoding.BS58));\n    keyStore.setKey(networkID, masterAccountID, nearKp);\n    connectConfig.deps = {\n      keyStore: keyStore,\n    };\n    connectConfig.keyStore = keyStore;\n  } else if (keyPath) {\n    const keyStore = new InMemoryKeyStore();\n    connectConfig.deps = {\n      keyStore: keyStore,\n    };\n  } else {\n    throw 'A key path or key pair must be provided';\n  }\n\n  const near = await connect(connectConfig);\n\n  return {\n    near,\n    networkID,\n    rpcProvider: new providers.JsonRpcProvider(nodeUrl),\n    nearMasterAccount: await near.account(masterAccountID),\n  };\n}\n","export * from './types';\nexport * from './switches';\n","import {\n  InferChainInterface,\n  Chain,\n  InferInner,\n  InferWrapChainInterface,\n  InferInitParams,\n} from '@baf-wallet/interfaces';\nimport { nearChainInterface } from '@baf-wallet/near';\n\n// these are kind of ugly, but the ugly should be limited to here, all in the pursuit of typed-ness and editor completions\n\n// NOTE: This will return the wrong type if you put in a type paramteter that conflicts with the 'chain' argument\nexport async function getWrappedInterface<T>(\n  chain: Chain,\n  initParams: InferInitParams<T>\n): Promise<InferWrapChainInterface<T>> {\n  const chainInterface = getChainInterface<T>(chain);\n  return await wrapChainInterface(chainInterface, initParams);\n}\n\n// NOTE: This will return the wrong type if you put in a type paramter that conflicts with the 'chain' argument\nexport function getChainInterface<T>(chain: Chain): InferChainInterface<T> {\n  switch (chain) {\n    case Chain.NEAR:\n      return nearChainInterface as InferChainInterface<T>;\n    default:\n      throw new Error(`Unsupported chain ${chain}`);\n  }\n}\n\nexport async function wrapChainInterface<T>(\n  unwrapped: InferChainInterface<T>,\n  initParams: InferInitParams<T>\n): Promise<InferWrapChainInterface<T>> {\n  const innerSdk = await (unwrapped.init(initParams) as Promise<InferInner<T>>);\n\n  const wrapped = {\n    rpc: unwrapped.rpc(innerSdk),\n    tx: unwrapped.tx(innerSdk),\n    accounts: unwrapped.accounts(innerSdk),\n    convert: unwrapped.convert,\n\n    // Note: in the future, some chainInterfaces might want to do stuff in this fn\n    getInner: () => innerSdk,\n  };\n\n  return wrapped as InferWrapChainInterface<T>;\n}\n","import { Encoding, PublicKey, secp256k1 } from '@baf-wallet/interfaces';\nimport Torus from '@toruslabs/torus.js';\nimport NodeDetailsManager from '@toruslabs/fetch-node-details';\nimport * as fetch from 'node-fetch';\nimport { torusConstants, TORUS_LOGIN_TYPE } from './constants';\nimport { pkSecpFromXY } from '@baf-wallet/crypto';\n\nconst torus = new Torus({\n  metadataHost: 'https://metadata.tor.us',\n  allowHost: 'https://signer.tor.us/api/allow',\n});\nTorus.setAPIKey('torus-default');\n\nexport async function getTorusPublicAddress(\n  userId: string,\n  loginType: TORUS_LOGIN_TYPE\n): Promise<PublicKey<secp256k1>> {\n  assertLoginTypeRegistered(loginType);\n  // Configuration from https://github.com/torusresearch/torus-direct-web-sdk/blob/master/src/login.ts\n  const nodeManager = new NodeDetailsManager({\n    network: torusConstants.network,\n    proxyAddress: torusConstants.proxyAddress,\n  });\n\n  const {\n    torusNodeEndpoints,\n    torusNodePub,\n    torusIndexes,\n  } = await nodeManager.getNodeDetails();\n\n  (global as any).fetch = fetch;\n  console.log(torusNodeEndpoints, torusNodePub);\n  const torusPublicKey = await torus.getPublicAddress(\n    torusNodeEndpoints,\n    torusNodePub,\n    {\n      verifier: torusConstants.verifierInfo[loginType].verifier,\n      verifierId: userId,\n    },\n    true\n  );\n\n  return pkSecpFromXY((torusPublicKey as any).X, (torusPublicKey as any).Y);\n}\n\nexport function assertLoginTypeRegistered(\n  loginType: TORUS_LOGIN_TYPE\n): boolean {\n  if (!torusConstants.verifierInfo[loginType])\n    throw `No verifier info exits for login type ${loginType}`;\n  return true;\n}\n","module.exports = require(\"express\");","/* tslint:disable */\n/* eslint-disable */\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\nimport { Controller, ValidationService, FieldErrors, ValidateError, TsoaRoute, HttpStatusCodeLiteral, TsoaResponse } from '@tsoa/runtime';\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\nimport { DiscordController } from './../src/app/controllers/DiscordController';\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\nimport { NearController } from './../src/app/controllers/NearController';\nimport * as express from 'express';\n\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\nconst models: TsoaRoute.Models = {\n    \"RevokeTokenParams\": {\n        \"dataType\": \"refObject\",\n        \"properties\": {\n            \"token\": {\"dataType\":\"string\",\"required\":true},\n        },\n        \"additionalProperties\": false,\n    },\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n    \"hexString\": {\n        \"dataType\": \"refAlias\",\n        \"type\": {\"dataType\":\"string\",\"validators\":{}},\n    },\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n    \"CreateNearAccountParams\": {\n        \"dataType\": \"refObject\",\n        \"properties\": {\n            \"userID\": {\"dataType\":\"string\",\"required\":true},\n            \"nonce\": {\"ref\":\"hexString\",\"required\":true},\n            \"secpSigHex\": {\"ref\":\"hexString\",\"required\":true},\n            \"secpSig_s\": {\"ref\":\"hexString\",\"required\":true},\n            \"edPubkey\": {\"ref\":\"hexString\",\"required\":true},\n            \"edSigHex\": {\"ref\":\"hexString\",\"required\":true},\n            \"accountID\": {\"dataType\":\"string\",\"required\":true},\n        },\n        \"additionalProperties\": false,\n    },\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n    \"NearAccountInfo\": {\n        \"dataType\": \"refObject\",\n        \"properties\": {\n            \"near_id\": {\"dataType\":\"union\",\"subSchemas\":[{\"dataType\":\"string\"},{\"dataType\":\"enum\",\"enums\":[null]}],\"required\":true},\n        },\n        \"additionalProperties\": false,\n    },\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n};\nconst validationService = new ValidationService(models);\n\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\nexport function RegisterRoutes(app: express.Router) {\n    // ###########################################################################################################\n    //  NOTE: If you do not see routes for all of your controllers in this file, then you might not have informed tsoa of where to look\n    //      Please look into the \"controllerPathGlobs\" config option described in the readme: https://github.com/lukeautry/tsoa\n    // ###########################################################################################################\n        app.post('/discord/revoke-token',\n            function DiscordController_revokeToken(request: any, response: any, next: any) {\n            const args = {\n                    accessToken: {\"in\":\"body\",\"name\":\"accessToken\",\"required\":true,\"ref\":\"RevokeTokenParams\"},\n            };\n\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n            let validatedArgs: any[] = [];\n            try {\n                validatedArgs = getValidatedArgs(args, request, response);\n            } catch (err) {\n                return next(err);\n            }\n\n            const controller = new DiscordController();\n\n\n            const promise = controller.revokeToken.apply(controller, validatedArgs as any);\n            promiseHandler(controller, promise, response, undefined, next);\n        });\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n        app.post('/near/account',\n            function NearController_createNearAccount(request: any, response: any, next: any) {\n            const args = {\n                    requestBody: {\"in\":\"body\",\"name\":\"requestBody\",\"required\":true,\"ref\":\"CreateNearAccountParams\"},\n            };\n\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n            let validatedArgs: any[] = [];\n            try {\n                validatedArgs = getValidatedArgs(args, request, response);\n            } catch (err) {\n                return next(err);\n            }\n\n            const controller = new NearController();\n\n\n            const promise = controller.createNearAccount.apply(controller, validatedArgs as any);\n            promiseHandler(controller, promise, response, undefined, next);\n        });\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n        app.get('/near/account/:secpPubkeyB58/nonce',\n            function NearController_getAccountNonce(request: any, response: any, next: any) {\n            const args = {\n                    secpPubkeyB58: {\"in\":\"path\",\"name\":\"secpPubkeyB58\",\"required\":true,\"dataType\":\"string\"},\n            };\n\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n            let validatedArgs: any[] = [];\n            try {\n                validatedArgs = getValidatedArgs(args, request, response);\n            } catch (err) {\n                return next(err);\n            }\n\n            const controller = new NearController();\n\n\n            const promise = controller.getAccountNonce.apply(controller, validatedArgs as any);\n            promiseHandler(controller, promise, response, undefined, next);\n        });\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n        app.get('/near/account/:secpPubkeyB58/id',\n            function NearController_getAccountInfo(request: any, response: any, next: any) {\n            const args = {\n                    secpPubkeyB58: {\"in\":\"path\",\"name\":\"secpPubkeyB58\",\"required\":true,\"dataType\":\"string\"},\n            };\n\n            // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n            let validatedArgs: any[] = [];\n            try {\n                validatedArgs = getValidatedArgs(args, request, response);\n            } catch (err) {\n                return next(err);\n            }\n\n            const controller = new NearController();\n\n\n            const promise = controller.getAccountInfo.apply(controller, validatedArgs as any);\n            promiseHandler(controller, promise, response, undefined, next);\n        });\n        // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n    function isController(object: any): object is Controller {\n        return 'getHeaders' in object && 'getStatus' in object && 'setStatus' in object;\n    }\n\n    function promiseHandler(controllerObj: any, promise: any, response: any, successStatus: any, next: any) {\n        return Promise.resolve(promise)\n            .then((data: any) => {\n                let statusCode = successStatus;\n                let headers;\n                if (isController(controllerObj)) {\n                    headers = controllerObj.getHeaders();\n                    statusCode = controllerObj.getStatus() || statusCode;\n                }\n\n                // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n                returnHandler(response, statusCode, data, headers)\n            })\n            .catch((error: any) => next(error));\n    }\n\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n    function returnHandler(response: any, statusCode?: number, data?: any, headers: any = {}) {\n        if (response.headersSent) {\n            return;\n        }\n        Object.keys(headers).forEach((name: string) => {\n            response.set(name, headers[name]);\n        });\n        if (data && typeof data.pipe === 'function' && data.readable && typeof data._read === 'function') {\n            data.pipe(response);\n        } else if (data !== null && data !== undefined) {\n            response.status(statusCode || 200).json(data);\n        } else {\n            response.status(statusCode || 204).end();\n        }\n    }\n\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n    function responder(response: any): TsoaResponse<HttpStatusCodeLiteral, unknown>  {\n        return function(status, data, headers) {\n            returnHandler(response, status, data, headers);\n        };\n    };\n\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n\n    function getValidatedArgs(args: any, request: any, response: any): any[] {\n        const fieldErrors: FieldErrors  = {};\n        const values = Object.keys(args).map((key) => {\n            const name = args[key].name;\n            switch (args[key].in) {\n                case 'request':\n                    return request;\n                case 'query':\n                    return validationService.ValidateParam(args[key], request.query[name], name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                case 'path':\n                    return validationService.ValidateParam(args[key], request.params[name], name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                case 'header':\n                    return validationService.ValidateParam(args[key], request.header(name), name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                case 'body':\n                    return validationService.ValidateParam(args[key], request.body, name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                case 'body-prop':\n                    return validationService.ValidateParam(args[key], request.body[name], name, fieldErrors, 'body.', {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                case 'formData':\n                    if (args[key].dataType === 'file') {\n                        return validationService.ValidateParam(args[key], request.file, name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                    } else if (args[key].dataType === 'array' && args[key].array.dataType === 'file') {\n                        return validationService.ValidateParam(args[key], request.files, name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                    } else {\n                        return validationService.ValidateParam(args[key], request.body[name], name, fieldErrors, undefined, {\"noImplicitAdditionalProperties\":\"throw-on-extras\"});\n                    }\n                case 'res':\n                    return responder(response);\n            }\n        });\n\n        if (Object.keys(fieldErrors).length > 0) {\n            throw new ValidateError(fieldErrors, '');\n        }\n        return values;\n    }\n\n    // WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n}\n\n// WARNING: This file was auto-generated with tsoa. Please do not modify it. Re-run tsoa to re-generate this file: https://github.com/lukeautry/tsoa\n","import {\n  Body,\n  Controller,\n  Get,\n  Path,\n  Post,\n  Route,\n  SuccessResponse,\n} from 'tsoa';\nimport {\n  discordRevokeAccessToken,\n  DiscordPublicInfo,\n} from '../service/discord';\n\ninterface RevokeTokenParams {\n  token: string;\n}\n\n@Route('discord')\nexport class DiscordController extends Controller {\n  @SuccessResponse('204')\n  @Post('revoke-token')\n  public async revokeToken(\n    @Body() accessToken: RevokeTokenParams\n  ): Promise<void> {\n    await discordRevokeAccessToken(accessToken.token);\n  }\n}\n","import FormData from 'form-data';\nimport axios from 'axios';\nimport { constants } from '../config/constants';\nimport * as discord from 'discord.js';\n\nexport interface DiscordPublicInfo {\n  verifierId: string;\n}\n\nexport async function discordRevokeAccessToken(token: string) {\n  const formData = new FormData();\n  formData.append('token', token);\n  const res = await axios.post(\n    'https://discordapp.com/api/oauth2/token/revoke',\n    formData,\n    {\n      headers: {\n        ...formData.getHeaders(),\n        Authorization: `Basic ${Buffer.from(\n          `${constants.discord.clientId}:${constants.discord.clientSecret}`,\n          'binary'\n        ).toString('base64')}`,\n      },\n    }\n  );\n}\n","module.exports = require(\"form-data\");","module.exports = require(\"axios\");","module.exports = require(\"js-sha3\");","module.exports = require(\"js-sha256\");","import {\n  KeyPair,\n  TxInterface,\n  PublicKey,\n  secp256k1,\n  ed25519,\n  ExplorerLink,\n  GenericTxParams,\n  GenericTxSupportedActions,\n  GenericTxAction,\n  GenericTxActionTransfer,\n} from '@baf-wallet/interfaces';\nimport { Pair, getEnumValues } from '@baf-wallet/utils';\nimport { sha256 } from '@baf-wallet/crypto';\nimport { Buffer } from 'buffer';\nimport BN from 'bn.js';\nimport {\n  KeyPair as NearKeyPair,\n  keyStores,\n  providers,\n  transactions,\n  utils,\n} from 'near-api-js';\n\nimport { NearState } from './near';\nimport { NearSendOpts, NearSendResult } from './rpc';\nimport { NearAccountID } from './accounts';\nimport { nearConverter } from './convert';\nimport {\n  Action as NearNativeAction,\n  SignedTransaction,\n  Transaction,\n  signTransaction,\n} from 'near-api-js/lib/transaction';\nimport { getBafContract } from '@baf-wallet/baf-contract';\n\nexport type NearTxInterface = TxInterface<\n  Transaction,\n  NearBuildTxParams,\n  SignedTransaction,\n  NearSignTxOpts,\n  NearSendOpts,\n  NearSendResult\n>;\nexport type NearSupportedActionTypes = GenericTxSupportedActions;\nexport type NearTransaction = Transaction;\ninterface NearActionParam {\n  // used to type check the parameter input\n  discriminator: NearSupportedActionTypes;\n}\nexport interface NearTransferParam extends NearActionParam {\n  // a string number value in Yocto\n  amount: string;\n}\nexport type NearAction = GenericTxAction;\nexport interface NearBuildTxParams {\n  actions: NearAction[];\n  senderPk: PublicKey<ed25519>;\n  senderAccountID: NearAccountID;\n  recipientAccountID: NearAccountID;\n}\nexport interface NearSignTxOpts {}\n\nexport function nearTx(innerSdk: NearState): NearTxInterface {\n  return {\n    build: buildNearTx(innerSdk),\n    sign: signNearTx,\n    send: sendNearTx(innerSdk),\n    buildParamsFromGenericTx: buildParamsFromGenericTx(innerSdk),\n    extractGenericActionsFromTx,\n  };\n}\n\nfunction buildNativeAction(action: NearAction): NearNativeAction {\n  switch (action.type) {\n    case GenericTxSupportedActions.TRANSFER:\n      return transactions.transfer(\n        new BN((action as GenericTxActionTransfer).amount, 10)\n      );\n    default:\n      throw `Action of type ${action.type} is unsupported`;\n  }\n}\n\nexport const extractGenericActionsFromTx = (\n  txParams: NearBuildTxParams\n): GenericTxAction[] => {\n  return txParams.actions;\n};\n\nexport const buildParamsFromGenericTx = (innerSdk: NearState) => async (\n  txParams: GenericTxParams,\n  recipientPk: PublicKey<secp256k1>,\n  _senderPk: PublicKey<secp256k1>,\n  senderPk: PublicKey<ed25519>\n): Promise<NearBuildTxParams> => {\n  const recipientAccountID = await getBafContract().getAccountId(recipientPk);\n  const nearTransferParams: NearBuildTxParams = {\n    actions: txParams.actions,\n    senderPk: senderPk,\n    senderAccountID: innerSdk.nearMasterAccount.accountId,\n    recipientAccountID,\n  };\n  return nearTransferParams;\n};\n\nexport const buildNearTx = (innerSdk: NearState) => async ({\n  actions,\n  senderPk,\n  senderAccountID,\n  recipientAccountID,\n}: NearBuildTxParams): Promise<Transaction> => {\n  const nearSenderPk = nearConverter.pkFromUnified(senderPk);\n  const accessKey = await innerSdk.rpcProvider.query(\n    `access_key/${senderAccountID}/${nearSenderPk.toString()}`,\n    ''\n  );\n\n  const nonce = ++accessKey.nonce;\n  const recentBlockHash = utils.serialize.base_decode(accessKey.block_hash);\n  const nativeActions = actions.map(buildNativeAction);\n\n  return transactions.createTransaction(\n    senderAccountID,\n    nearSenderPk,\n    recipientAccountID,\n    nonce,\n    nativeActions,\n    recentBlockHash\n  );\n};\n\nexport async function signNearTx<Curve>(\n  tx: transactions.Transaction,\n  keyPair: KeyPair<Curve>,\n  _opts?: NearSignTxOpts\n): Promise<transactions.SignedTransaction> {\n  const nearKeyPair = nearConverter.keyPairFromUnified(keyPair);\n  const serializedTx = utils.serialize.serialize(transactions.SCHEMA, tx);\n  const serializedTxHash = new Uint8Array(sha256(Buffer.from(serializedTx)));\n  const signature = nearKeyPair.sign(serializedTxHash);\n  // const [_, signedTx] = await signTransaction(tx, )\n  return new transactions.SignedTransaction({\n    transaction: tx,\n    signature: new transactions.Signature({\n      keyType: tx.publicKey.keyType,\n      data: signature.signature,\n    }),\n  });\n}\n\nexport const sendNearTx = (innerSdk: NearState) => async (\n  tx: SignedTransaction\n): Promise<Pair<NearSendResult, ExplorerLink>> => {\n  const serialized = tx.encode();\n  const result = await innerSdk.rpcProvider.sendJsonRpc('broadcast_tx_commit', [\n    Buffer.from(serialized).toString('base64'),\n  ]);\n\n  const explorerLink = `https://explorer.${innerSdk.networkID}.near.org/transactions/${result.transaction.hash}`;\n  return {\n    fst: result,\n    snd: explorerLink,\n  };\n};\n","module.exports = require(\"bn.js\");","import { RpcInterface } from '@baf-wallet/interfaces';\nimport { transactions } from 'near-api-js';\nimport { NearNetworkID, stringToNetworkID } from './utils';\nimport { NearState } from './near';\n\nexport type NearRpcInterface = RpcInterface<\n  transactions.Transaction,\n  transactions.SignedTransaction,\n  NearSendOpts,\n  NearSendResult\n>;\n\n// TODO: go spelunking in near's jsonRpcProvider and see what options it takes\n// and see what kind of stuff it actually returns so we can do better than 'any'\nexport interface NearSendOpts {}\nexport type NearSendResult = any;\n\n// * add more RPC methods as they are needed\n\nexport function nearRpc(_innerSdk: NearState): NearRpcInterface {\n  return {\n    endpoint: getNodeUrl,\n  };\n}\n\nexport function getNodeUrl(network?: string): string {\n  const networkID: NearNetworkID = stringToNetworkID(network ?? 'mainnet');\n  return `https://rpc.${networkID}.near.org`;\n}\n","import {\n  AccountsInterface,\n  Balance,\n  ed25519,\n  secp256k1,\n} from '@baf-wallet/interfaces';\nimport { Account as NearAccount } from 'near-api-js';\nimport {\n  AccountCreator,\n  UrlAccountCreator,\n  LocalAccountCreator,\n} from 'near-api-js/lib/account_creator';\nimport BN from 'bn.js';\n\nimport { PublicKey } from '@baf-wallet/interfaces';\nimport { NearState } from './near';\nimport { nearConverter } from './convert';\n\nexport type NearAccountID = string;\n\nexport function nearAccounts(\n  nearState: NearState\n): AccountsInterface<NearAccount, NearAccountID, NearCreateAccountParams> {\n  const { near } = nearState;\n  return {\n    lookup: async (accountID: NearAccountID): Promise<NearAccount> =>\n      await near.account(accountID),\n\n    getGenericMasterAccount: () => {\n      return {\n        getBalance: async () =>\n          (await nearState.nearMasterAccount.getAccountBalance())\n            .total as Balance,\n      };\n    },\n    create: async ({\n      accountID,\n      newAccountPk,\n      initialBalance,\n      method = 'helper',\n    }: NearCreateAccountParams): Promise<NearAccount> => {\n      if (method === 'local' && !initialBalance) {\n        throw 'An initial balance must be specified when using a local account creator';\n      }\n      const masterAccount = await near.account(near.config.masterAccount);\n      const accountCreator: AccountCreator =\n        method === 'helper'\n          ? new UrlAccountCreator(near.connection, near.config.helperUrl)\n          : new LocalAccountCreator(masterAccount, initialBalance);\n\n      await accountCreator.createAccount(\n        accountID,\n        nearConverter.pkFromUnified(newAccountPk)\n      );\n      return await near.account(accountID);\n    },\n  };\n}\n\nexport interface NearCreateAccountParams {\n  accountID: NearAccountID;\n  newAccountPk: PublicKey<ed25519 | secp256k1>;\n  initialBalance?: BN;\n  method?: 'helper' | 'local';\n}\n","module.exports = require(\"near-api-js/lib/utils\");","module.exports = require(\"dotenv\");","export * from './lib';\n","export * from './constants';\nexport * from './torus';\n","module.exports = require(\"@toruslabs/fetch-node-details\");","module.exports = require(\"node-fetch\");","import * as bodyParser from 'body-parser';\nimport express from 'express';\nimport { RegisterRoutes } from '../build/routes';\nimport { constants } from './app/config/constants';\nimport * as cors from 'cors';\nimport { setBafContract } from '@baf-wallet/baf-contract';\nimport { Chain } from '@baf-wallet/interfaces';\nimport { getNearChain, initChains } from './app/chains/singletons';\n\nconst app = express();\n\nasync function initContracts() {\n  const masterAccount = await getNearChain().accounts.lookup(\n    constants.chainParams[Chain.NEAR].masterAccountID\n  );\n  await setBafContract(masterAccount);\n}\n\nasync function init() {\n  await initChains();\n  await initContracts();\n  app.use(\n    bodyParser.urlencoded({\n      extended: true,\n    })\n  );\n  app.use(bodyParser.json());\n  // const whitelist = [\n  //   'http://localhost:8080',\n  //   'https://baf-wallet.netlify.app',\n  //   'https://baf-wallet-v2-git-deploy-work-baf-wallet.vercel.app',\n  // ];\n  // const corsOptions = {\n  //   origin: function (origin, callback) {\n  //     if (whitelist.indexOf(origin) !== -1) {\n  //       callback(null, true);\n  //     } else {\n  //       callback(new Error('Not allowed by CORS'));\n  //     }\n  //   },\n  // };\n  // app.use(cors(corsOptions));\n\n  RegisterRoutes(app);\n\n  const port = process.env.port || 3333;\n  const server = app.listen(port, () => {\n    console.log(`Listening at http://localhost:${port}/`);\n  });\n  server.on('error', console.error);\n}\ninit();\n"],"sourceRoot":""}